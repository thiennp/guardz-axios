# Guardz Ecosystem Documentation

## Overview

The **Guardz ecosystem** is a comprehensive TypeScript type guard solution designed to bring runtime type safety to your applications. It consists of four core components that work seamlessly together to provide end-to-end type safety across your entire application stack.

## 🌟 **Ecosystem Components**

### 1. **[guardz](https://www.npmjs.com/package/guardz)** - Core Type Guard Library

The foundation of the ecosystem, providing 50+ built-in type guards and utilities for runtime type validation.

#### Installation

```bash
npm install guardz
```

#### Key Features

- **50+ built-in type guards** for all JavaScript types
- **Composite type guard creation** with `isType()` and `isOneOf()`
- **Array and object validation** with `isArrayOf()` and `isRecord()`
- **Optional and nullable types** with `isOptional()` and `isNullable()`
- **Union and intersection types** with `isUnion()` and `isIntersection()`
- **Custom type guard creation** for complex validation scenarios
- **Performance optimized** with minimal runtime overhead

#### Basic Usage

```typescript
import { isType, isString, isNumber, isOptional, isArrayOf } from "guardz";

interface User {
  id: number;
  name: string;
  email?: string;
  tags: string[];
}

const isUser = isType<User>({
  id: isNumber,
  name: isString,
  email: isOptional(isString),
  tags: isArrayOf(isString),
});

// Runtime validation
if (isUser(data)) {
  // data is guaranteed to be User type
  console.log(data.name); // Type-safe access
}
```

#### Advanced Usage

```typescript
import { isType, isString, isNumber, isUnion, isRecord } from "guardz";

// Union types
const isStatus = isUnion(["active", "inactive", "pending"]);

// Record types
const isUserMap = isRecord(isString, isUser);

// Complex nested types
interface Post {
  id: number;
  title: string;
  author: User;
  metadata: Record<string, unknown>;
}

const isPost = isType<Post>({
  id: isNumber,
  title: isString,
  author: isUser,
  metadata: isRecord(isString, isUnknown),
});
```

### 2. **[guardz-generator](https://www.npmjs.com/package/guardz-generator)** - Automatic Type Guard Generation

Automatically generates type guards from your TypeScript interfaces and types, eliminating manual type guard creation.

#### Installation

```bash
npm install guardz-generator
```

#### Key Features

- **Automatic generation** from TypeScript interfaces
- **CLI tool** for batch processing
- **Watch mode** for development workflows
- **Custom templates** for specialized guards
- **Integration** with build tools and IDEs
- **TypeScript compiler integration** for accurate type analysis

#### Basic Usage

```bash
# Generate guards from all TypeScript files
npx guardz-generator generate "src/**/*.ts"

# Watch mode for development
npx guardz-generator watch "src/**/*.ts"

# Generate guards for specific files
npx guardz-generator generate src/types/user.ts src/types/post.ts
```

#### Configuration

Create a `guardz-generator.config.js` file:

```javascript
module.exports = {
  input: "src/**/*.ts",
  output: "src/guards",
  template: "default",
  options: {
    includeInterfaces: true,
    includeTypes: true,
    includeEnums: true,
    generateIndex: true,
  },
};
```

#### Generated Output

```typescript
// Auto-generated from interface User
export const isUser = isType<User>({
  id: isNumber,
  name: isString,
  email: isOptional(isString),
  tags: isArrayOf(isString),
});

// Auto-generated from interface Post
export const isPost = isType<Post>({
  id: isNumber,
  title: isString,
  content: isString,
  author: isUser,
  publishedAt: isOptional(isString),
});

// Auto-generated index file
export * from "./user.guards";
export * from "./post.guards";
```

#### Integration with Build Tools

```json
// package.json
{
  "scripts": {
    "generate:guards": "guardz-generator generate \"src/**/*.ts\"",
    "watch:guards": "guardz-generator watch \"src/**/*.ts\"",
    "build": "npm run generate:guards && tsc",
    "dev": "npm run watch:guards & tsc --watch"
  }
}
```

### 3. **[guardz-axios](https://www.npmjs.com/package/guardz-axios)** - Type-Safe HTTP Client

Type-safe HTTP client with runtime validation, built on top of Axios.

#### Installation

```bash
npm install guardz-axios guardz axios
```

#### Key Features

- **Runtime validation** of all HTTP responses
- **Type-safe results** with discriminated unions
- **Multiple API patterns** (curried, fluent, configuration-first)
- **Retry logic** with exponential backoff
- **Tolerance mode** for graceful degradation
- **Comprehensive error handling**

#### Basic Usage

```typescript
import { safeGet } from "guardz-axios";
import { isUser } from "./guards"; // Generated by guardz-generator

const result = await safeGet({ guard: isUser })("/users/1");

if (result.status === Status.SUCCESS) {
  console.log(result.data.name); // Type-safe access
} else {
  console.error(`Error: ${result.message}`);
}
```

#### Advanced Usage

```typescript
import { safeRequest } from "guardz-axios";

const result = await safeRequest({
  url: "/users/1",
  method: "GET",
  guard: isUser,
  timeout: 5000,
  retry: {
    attempts: 3,
    delay: 1000,
    backoff: "exponential",
  },
  tolerance: true,
  onError: (error, context) => {
    console.warn(`Validation warning: ${error}`);
  },
});
```

### 4. **[guardz-event](https://www.npmjs.com/package/guardz-event)** - Type-Safe Event Handling

Type-safe event handling with runtime validation, perfect for event-driven architectures.

#### Installation

```bash
npm install guardz-event guardz
```

#### Key Features

- **Type-safe event emitters** with runtime validation
- **Event type guards** for payload validation
- **Event listeners** with automatic type inference
- **Event middleware** for transformation and filtering
- **Event history** and replay capabilities
- **Integration** with Node.js EventEmitter and browser events

#### Basic Usage

```typescript
import { createTypedEventEmitter } from "guardz-event";
import { isType, isString, isNumber } from "guardz";

interface UserCreatedEvent {
  userId: number;
  userName: string;
}

const isUserCreatedEvent = isType<UserCreatedEvent>({
  userId: isNumber,
  userName: isString,
});

const emitter = createTypedEventEmitter({
  "user:created": isUserCreatedEvent,
});

// Type-safe event emission
emitter.emit("user:created", { userId: 1, userName: "John" });

// Type-safe event listening
emitter.on("user:created", (event) => {
  console.log(`User created: ${event.userName} (ID: ${event.userId})`);
  // event is fully typed as UserCreatedEvent
});
```

#### Advanced Usage

```typescript
import { createTypedEventEmitter, EventMiddleware } from "guardz-event";

// Event middleware for transformation
const loggingMiddleware: EventMiddleware = (event, next) => {
  console.log(`Event emitted: ${event.type}`, event.payload);
  return next(event);
};

const emitter = createTypedEventEmitter(
  {
    "user:created": isUserCreatedEvent,
    "user:updated": isUserUpdatedEvent,
  },
  {
    middleware: [loggingMiddleware],
  },
);

// Event history and replay
const history = emitter.getHistory();
emitter.replay(history);
```

## 🔄 **Ecosystem Integration**

### Complete Workflow Example

```typescript
// 1. Define your types
interface User {
  id: number;
  name: string;
  email: string;
}

interface Post {
  id: number;
  title: string;
  content: string;
  author: User;
}

// 2. Generate type guards automatically
// npx guardz-generator generate "src/**/*.ts"
// This creates: src/guards/user.guards.ts, src/guards/post.guards.ts

// 3. Use in HTTP requests
import { safeGet, safePost } from "guardz-axios";
import { isUser, isPost } from "./guards";

const userResult = await safeGet({ guard: isUser })("/users/1");
const postResult = await safePost({ guard: isPost })("/posts", {
  title: "New Post",
  content: "Post content",
  authorId: 1,
});

// 4. Use in event handling
import { createTypedEventEmitter } from "guardz-event";

const emitter = createTypedEventEmitter({
  "user:fetched": isUser,
  "post:created": isPost,
});

if (userResult.status === Status.SUCCESS) {
  emitter.emit("user:fetched", userResult.data);
}

if (postResult.status === Status.SUCCESS) {
  emitter.emit("post:created", postResult.data);
}

// 5. Listen to events
emitter.on("user:fetched", (user) => {
  console.log(`User fetched: ${user.name}`);
});

emitter.on("post:created", (post) => {
  console.log(`Post created: ${post.title} by ${post.author.name}`);
});
```

### Integration Patterns

#### API Development

```typescript
// API layer with full type safety
class UserAPI {
  private emitter = createTypedEventEmitter({
    "user:created": isUser,
    "user:updated": isUser,
    "user:deleted": isUserDeletedEvent,
  });

  async createUser(userData: CreateUserData): Promise<RequestResult<User>> {
    const result = await safePost({ guard: isUser })("/users", userData);

    if (result.status === Status.SUCCESS) {
      this.emitter.emit("user:created", result.data);
    }

    return result;
  }

  async getUser(id: number): Promise<RequestResult<User>> {
    return await safeGet({ guard: isUser })(`/users/${id}`);
  }
}
```

#### Microservices Communication

```typescript
// Service A: User Service
const userEmitter = createTypedEventEmitter({
  "user:created": isUser,
  "user:updated": isUser,
});

// Service B: Notification Service
const notificationEmitter = createTypedEventEmitter({
  "notification:sent": isNotification,
});

// Type-safe inter-service communication
userEmitter.on("user:created", (user) => {
  // Send welcome notification
  notificationEmitter.emit("notification:sent", {
    type: "welcome",
    userId: user.id,
    message: `Welcome ${user.name}!`,
  });
});
```

#### Frontend State Management

```typescript
// React/Redux integration
import { createTypedEventEmitter } from "guardz-event";

const storeEmitter = createTypedEventEmitter({
  "state:user:updated": isUser,
  "state:posts:loaded": isArrayOf(isPost),
});

// Type-safe state updates
storeEmitter.on("state:user:updated", (user) => {
  // Update Redux store with type-safe user data
  store.dispatch(updateUser(user));
});

storeEmitter.on("state:posts:loaded", (posts) => {
  // Update Redux store with type-safe posts data
  store.dispatch(loadPosts(posts));
});
```

## 🚀 **Getting Started with the Ecosystem**

### 1. Install All Packages

```bash
npm install guardz guardz-generator guardz-axios guardz-event
```

### 2. Set Up Project Structure

```
src/
├── types/
│   ├── user.ts
│   ├── post.ts
│   └── index.ts
├── guards/          # Auto-generated
│   ├── user.guards.ts
│   ├── post.guards.ts
│   └── index.ts
├── api/
│   ├── user-api.ts
│   └── post-api.ts
├── events/
│   ├── user-events.ts
│   └── post-events.ts
└── index.ts
```

### 3. Configure Package Scripts

```json
{
  "scripts": {
    "generate:guards": "guardz-generator generate \"src/types/**/*.ts\"",
    "watch:guards": "guardz-generator watch \"src/types/**/*.ts\"",
    "build": "npm run generate:guards && tsc",
    "dev": "npm run watch:guards & tsc --watch"
  }
}
```

### 4. Define Your Types

```typescript
// src/types/user.ts
export interface User {
  id: number;
  name: string;
  email: string;
  createdAt: string;
}

// src/types/post.ts
export interface Post {
  id: number;
  title: string;
  content: string;
  author: User;
  publishedAt?: string;
}
```

### 5. Generate Type Guards

```bash
npm run generate:guards
```

### 6. Use in Your Application

```typescript
// src/api/user-api.ts
import { safeGet, safePost } from "guardz-axios";
import { isUser } from "../guards/user.guards";

export class UserAPI {
  async getUser(id: number) {
    return await safeGet({ guard: isUser })(`/users/${id}`);
  }

  async createUser(userData: Omit<User, "id" | "createdAt">) {
    return await safePost({ guard: isUser })("/users", userData);
  }
}

// src/events/user-events.ts
import { createTypedEventEmitter } from "guardz-event";
import { isUser } from "../guards/user.guards";

export const userEmitter = createTypedEventEmitter({
  "user:created": isUser,
  "user:updated": isUser,
  "user:deleted": isUserDeletedEvent,
});
```

## 🎯 **Use Cases**

### API Development

- Validate all incoming/outgoing API data
- Type-safe API client generation
- Runtime validation of external API responses
- Error handling with detailed type information

### Event-Driven Applications

- Type-safe event emission and handling
- Event payload validation
- Event middleware for transformation
- Event history and replay capabilities

### Microservices

- Ensure data consistency across services
- Type-safe inter-service communication
- Runtime validation of service boundaries
- Event-driven service orchestration

### Frontend Applications

- Validate API responses and user input
- Type-safe state management
- Event-driven UI updates
- Form validation with runtime type checking

### Backend Services

- Validate database queries and external API calls
- Type-safe data transformation
- Event-driven business logic
- Runtime validation of configuration

### Testing

- Generate type-safe test data
- Mock external dependencies with type safety
- Validate test fixtures and mocks
- Event-driven test scenarios

## 🔧 **Development Workflow**

### 1. Define Types

Create TypeScript interfaces for your data models:

```typescript
interface User {
  id: number;
  name: string;
  email: string;
}
```

### 2. Generate Guards

Use guardz-generator to automatically create type guards:

```bash
npx guardz-generator generate "src/**/*.ts"
```

### 3. Use in HTTP Requests

Use guardz-axios for type-safe API calls:

```typescript
const result = await safeGet({ guard: isUser })("/users/1");
```

### 4. Handle Events

Use guardz-event for type-safe event communication:

```typescript
const emitter = createTypedEventEmitter({
  "user:updated": isUser,
});
```

### 5. Enjoy Runtime Safety

Full type safety across your entire application with minimal development overhead.

## 📚 **Documentation Links**

- **[guardz Documentation](https://github.com/thiennp/guardz)** - Core type guard library
- **[guardz-generator Documentation](https://github.com/thiennp/guardz-generator)** - Automatic type guard generation
- **[guardz-axios Documentation](https://github.com/thiennp/guardz-axios)** - Type-safe HTTP client
- **[guardz-event Documentation](https://github.com/thiennp/guardz-event)** - Type-safe event handling

## 🤝 **Contributing**

The guardz ecosystem is open source and welcomes contributions. Each component has its own repository:

- **[guardz](https://github.com/thiennp/guardz)** - Core library contributions
- **[guardz-generator](https://github.com/thiennp/guardz-generator)** - Generator tool contributions
- **[guardz-axios](https://github.com/thiennp/guardz-axios)** - HTTP client contributions
- **[guardz-event](https://github.com/thiennp/guardz-event)** - Event handling contributions

## 📄 **License**

All components of the guardz ecosystem are licensed under the MIT License.
